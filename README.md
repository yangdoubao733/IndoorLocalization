# 基于几何电磁孪生的室内非合作目标定位系统

## 项目简介
本系统通过读取SketchUp建模的室内环境，利用射线追踪算法进行电磁仿真，构建无线信号指纹库，实现室内目标的精确定位。

## 系统架构
```
├── src/
│   ├── models/         # 模型读取模块
│   ├── simulation/     # 电磁仿真模块
│   ├── fingerprint/    # 指纹库构建模块
│   ├── localization/   # 定位算法模块
│   └── utils/          # 工具函数
├── data/
│   ├── models/         # SketchUp模型文件
│   └── fingerprints/   # 生成的指纹库
└── results/            # 定位结果和可视化
```

## 主要功能
1. **模型导入**: 读取SketchUp模型（支持.dae/.obj格式）
2. **电磁仿真**: 基于射线追踪的信号传播模拟
3. **指纹库构建**: 生成位置-信号强度映射数据库
4. **定位算法**: K-NN、WKNN、概率定位算法
5. **非合作定位** ⭐新增⭐: 实时跟踪多种电磁信号设备
   - **支持信号类型**: WiFi、蓝牙、手机信号、RFID、ZigBee、LoRa、UWB
   - **模拟模式**：无需硬件，快速测试
   - **真实模式**：连接真实接收机设备
   - **多设备跟踪**：同时追踪不同类型的信号源
   - **实时可视化**：设备列表和3D地图
6. **可视化**: 3D模型展示、信号热图、定位轨迹

## 安装
```bash
pip install -r requirements.txt
```

## 使用方法

### 图形界面（推荐）
```bash
python gui.py
```
提供清晰易用的图形界面，包括：
- **选项卡1**: 构建指纹库 - 模型加载与指纹库生成
- **选项卡2**: 定位测试 - 单点定位和批量评估
- **选项卡3**: 非合作定位 ⭐新增⭐ - 实时设备跟踪
  - 支持WiFi、蓝牙、手机信号、RFID等多种电磁信号
  - 模拟模式：无需硬件，快速测试
  - 真实模式：连接真实接收机设备
  - 实时设备列表和3D地图
- **选项卡4**: 系统配置 - 参数调整

详细使用方法请参考：
- [非合作定位使用说明.md](非合作定位使用说明.md) - WiFi定位快速入门
- [通用电磁信号跟踪说明.md](通用电磁信号跟踪说明.md) - 多信号类型详细文档

### 命令行模式
```bash
# 构建指纹库
python main.py --mode build --model data/models/your_model.dae

# 执行定位
python main.py --mode locate --fingerprint data/fingerprints/fingerprint.pkl
```

**注意**: 默认模型单位为毫米(mm)，系统会自动转换为米(m)进行计算

## 技术原理
- **射线追踪**: 模拟电磁波传播路径
- **路径损耗模型**: 考虑自由空间损耗、反射、衍射
- **指纹匹配**: 基于欧氏距离的K近邻算法
